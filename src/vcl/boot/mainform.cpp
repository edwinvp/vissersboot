//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "mainform.h"
#include "fakeio.h"
//---------------------------------------------------------------------------
TinyGPS gps;
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TMainFrm *MainFrm;
//---------------------------------------------------------------------------
__fastcall TMainFrm::TMainFrm(TComponent* Owner)
	: TForm(Owner)
{
	main_init();
}
//---------------------------------------------------------------------------
void __fastcall TMainFrm::Timer1Timer(TObject *Sender)
{
	prog_ms += Timer1->Interval;

	if (CbRemoteCtrlOn->Checked) {
		pd5_pulse_duration=SbMotorV->Position;
		pd6_pulse_duration=SbMotorH->Position;
		pd3_pulse_duration=4000 - (SbPos->Position - 2000);
		pb3_pulse_duration=SbManAuto->Position;
	} else {
		// If the remote is off, no servo waveform is
		// generated by the receiver. So zeroes.
		pd6_pulse_duration=0;
		pd5_pulse_duration=0;
		pd3_pulse_duration=0;
		pb3_pulse_duration=0;
	}

	process(gps);

	if (prog_op.Length()) {
		if (ListBox1->Items->Count > 5)
			ListBox1->Clear();

		ListBox1->Items->Add(prog_op);
		prog_op="";
	}

	if (PORTB & _BV(PORTB5))
		ShLed->Brush->Color=clRed;
	else
		ShLed->Brush->Color=clBlack;



	TDrawingArea da;
	da.SetScreenDims(PaintBox1->Width,PaintBox1->Height);
	da.RenderTo(PaintBox1->Canvas);

}
//---------------------------------------------------------------------------
